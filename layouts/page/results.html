{{ if eq (getenv "NODE_ENV") "development" }}
{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://vuejs.org/js/vue.js" crossorigin="anonymous">
` }}{{ else }}{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js" crossorigin="anonymous">
` }}{{ end }}{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://cdn.jsdelivr.net/npm/vue-resource@1.3.5" crossorigin="anonymous">
<link rel="preload" src="/assets/scripts/index.js">
` }}{{ $.Scratch.Add "rootClass" "results-page" }}{{ partial "header.html" . }}

<article role="main" id="conteudo">
	<h1>{{ .Title }}</h1>

	{{ with .Content }}
		{{ . }}
	{{ end }}

	<div id="results__list" hidden>
		<noscript>{{ i18n "noScriptMessage" }}</noscript>
		<results-form v-bind:metadata="metadata"></results-form>
		<section class="results__list" :aria-busy="metadata.loading | booleanToString" v-if="profileList && profileList.length">
			<profile v-for="(profileItem, index) in profileList" v-bind:user="profileItem" v-bind:key="profileItem.username" :index="index" :remove-profile="removeProfile"></profile>
		</section>
		<results-footer v-bind:metadata="metadata" :cancel-request="cancelRequest"></results-footer>
	</div>

</article>

<script type="text/x-template" id="results__form">
	<form method="get" name="analisys_form" class="analisys-form--rebuild">
		<fieldset>
			<p v-show="!metadata.loading || metadata.total > 0">{{ i18n "returnedResults" "<output>{{ metadata.total }}</output>" | safeHTML }}</p>

			<input type="hidden" name="profile" :value="metadata.query.profile">
			<input type="hidden" name="socialnetwork" :value="metadata.query.socialnetwork">

			<input type="hidden" name="authenticated" :value="metadata.query.authenticated">
			<input type="hidden" name="oauth_token" :value="metadata.query.oauth_token">
			<input type="hidden" name="oauth_verifier" :value="metadata.query.oauth_verifier">

			<button v-show="metadata.query.search_for == 'profile'" name="search_for" value="followers" type="submit">{{ i18n "toCatchFollowers" }}</button>
			<button v-show="metadata.query.search_for == 'profile'" name="search_for" value="friends" type="submit">{{ i18n "toCatchFriends" }}</button>
		</fieldset>
	</form>
</script>

<script type="text/x-template" id="results__footer">
	<footer class="results__footer">

		<p v-if="metadata.download !== '' && metadata.download !== '.'">
			<a :href="metadata.download" id="results__export" download="resultados.json">
				{{ i18n "toExportData" }}
			</a>
		</p>

		<p class="results__progress" id="results__progress">
			{{ i18n "analysisProgress" "<strong>{{ metadata.current }} / {{ metadata.limit || metadata.total }}</strong>" | safeHTML }}
		</p>
		<button type="button" @click="cancelRequest" v-show="metadata.loading">{{ i18n "toStop" }}</button>
	</footer>
</script>

<script type="text/x-template" id="profile">
	{{ partial "profile.html" . }}
</script>

{{ if eq (getenv "NODE_ENV") "development" }}
{{ $.Scratch.Add "scriptsFooter" `
<script src="https://vuejs.org/js/vue.js"></script>
` }}
{{ else }}
{{ $.Scratch.Add "scriptsFooter" `
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
` }}
{{ end }}

{{ $.Scratch.Add "scriptsFooter" `
<script src="https://cdn.jsdelivr.net/npm/vue-resource@1.3.5"></script>
<script src="/assets/scripts/index.js"></script>
` }}
{{ partial "footer.html" . }}
