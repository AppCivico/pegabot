{{ if eq (getenv "NODE_ENV") "development" }}
{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://vuejs.org/js/vue.js" crossorigin="anonymous">
` }}{{ else }}{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js" crossorigin="anonymous">
` }}{{ end }}{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://cdn.jsdelivr.net/npm/vue-resource@1.3.5" crossorigin="anonymous">
<link rel="preload" src="/assets/scripts/index.js">
` }}{{ $.Scratch.Add "rootClass" "results-page" }}{{ partial "header.html" . }}

<article role="main" id="conteudo">
	<h1>{{ .Title }}</h1>

	{{ with .Content }}
		{{ $input := "(Pegabot)" }}
		{{ $output := "<b>$1</b>" }}
		{{ $finalContent := . | replaceRE $input $output | safeHTML }}
		{{ $finalContent }}
	{{ end }}

	<div id="results__list" class="results" hidden>
		<noscript>{{ i18n "noScriptMessage" }}</noscript>
		<section
			class="results__list"
			:aria-busy="(metadata.loading && profileList.length === 0) | booleanToString"
			data-loading-1="{{ i18n "analisysLoading-1" }}"
			data-loading-2="{{ i18n "analisysLoading-2" }}"
			data-loading-3="{{ i18n "analisysLoading-3" }}"
			data-loading-4="{{ i18n "analisysLoading-4" }}"
			data-loading-5="{{ i18n "analisysLoading-5" }}"
		>
			<profile
				v-for="(profileItem, index) in profileList"
				:user="profileItem"
				:key="profileItem.username"
				:index="index"
				:remove-profile="removeProfile"
				:focusable="profileList.length > 1 ? true : false"
				:to-approve="toApprove"
				:to-disapprove="toDisapprove"
			></profile>
		</section>
		<results-footer v-bind:metadata="metadata" :cancel-request="cancelRequest"></results-footer>
	</div>

	{{ range where (.Resources.Match "explain*") ".Kind" "page" }}
		<article
			class="
				delayed-entrance
				delayed-entrance__bottom
			"
		>
			<div class="container">
				<h2
					class="article__title"
				>
					{{ .Title }}
				</h2>

				{{ with .Params.figure }}
					<figure>
						<img src="{{ .src }}">
						<figcaption>
							<h4>{{ .caption }}</h4>
						</figcaption>
					</figure>
				{{ end }}

				<div class="article__content">
					{{ $input := "(Pegabot)" }}
					{{ $output := "<b>$1</b>" }}
					{{ $finalContent := .Content | replaceRE $input $output | safeHTML }}
					{{ $finalContent }}
				</div>
			</div>
		</article>
	{{ end }}

	{{ with .Site.GetPage "transparency/criteria" }}
		{{ .Render "article-with-resources" }}
	{{ end }}

	{{ range first 1 (where $.Site.Pages ".Type" "bookmark") }}
		{{ .Render "curved-section" }}
	{{ end }}

	{{ range where (.Resources.Match "methodology*") ".Kind" "page" }}
		<article
			class="
				{{ with .File }}{{ .TranslationBaseName }}{{ end }}
				alternate-paragraphs
				delayed-entrance
				delayed-entrance__bottom
			"
		>
			<div class="container">
				<h2
					class="article__title"
				>
					{{ .Title }}
				</h2>

				<div class="article__content">
					{{ $input := "(Pegabot)" }}
					{{ $output := "<b>$1</b>" }}
					{{ $finalContent := .Content | replaceRE $input $output | safeHTML }}
					{{ $finalContent }}
				</div>
			</div>
		</article>
	{{ end }}


	{{ range first 1 (after 1 (where $.Site.Pages ".Type" "bookmark")) }}
		{{ .Render "curved-section" }}
	{{ end }}

	{{ range where $.Site.Pages ".Type" "analysis" }}
		{{ .Render "analysis" }}
	{{ end }}

	{{ range first 1 (where (where $.Site.Pages ".Type" "callToAction") ".File.TranslationBaseName" "active-collaboration") }}
		{{ .Render "curved-section" }}
	{{ end }}
</article>

<script type="text/x-template" id="results__form">
	{{ partial "microtemplates/resultsForm.html" . }}
</script>

<script type="text/x-template" id="results__footer">
	{{ partial "microtemplates/resultsFooter.html" . }}
</script>

<script type="text/x-template" id="results__profile">
	{{ partial "microtemplates/resultsProfile.html" . }}
</script>

{{ if eq (getenv "NODE_ENV") "development" }}
{{ $.Scratch.Add "scriptsFooter" `
<script src="https://vuejs.org/js/vue.js"></script>
` }}
{{ else }}
{{ $.Scratch.Add "scriptsFooter" `
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
` }}
{{ end }}

{{ $.Scratch.Add "scriptsFooter" `
<script src="https://cdn.jsdelivr.net/npm/vue-resource@1.3.5"></script>
<script src="/assets/scripts/index.js"></script>
` }}
{{ partial "footer.html" . }}
