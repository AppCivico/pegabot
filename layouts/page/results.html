{{ if eq (getenv "NODE_ENV") "development" }}
{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://vuejs.org/js/vue.js" crossorigin="anonymous">
` }}{{ else }}{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js" crossorigin="anonymous">
` }}{{ end }}{{ $.Scratch.Add "scriptsHeader" `
<link rel="preload" src="https://cdn.jsdelivr.net/npm/vue-resource@1.3.5" crossorigin="anonymous">
<link rel="preload" src="/assets/scripts/index.js">
` }}{{ $.Scratch.Add "rootClass" "results-page" }}{{ partial "header.html" . }}

<article role="main" id="conteudo">
	<h1>{{ .Title }}</h1>

	{{ with .Content }}
		{{ . }}
	{{ end }}

	<div id="results__list" hidden>
		<noscript>{{ i18n "noScriptMessage" }}</noscript>
		<section class="results__list" :aria-busy="(metadata.loading && profileList.length === 0) | booleanToString">
			<profile v-for="(profileItem, index) in profileList" v-bind:user="profileItem" v-bind:key="profileItem.username" :index="index" :remove-profile="removeProfile"></profile>
		</section>
		<results-form v-bind:metadata="metadata"></results-form>
	</div>

</article>

<script type="text/x-template" id="results__form">
	<form method="get" name="analisys_form" class="analisys-form--rebuild">
		<fieldset>
			<p v-show="!metadata.loading || metadata.total > 0">{{ i18n "returnedResults" "<output>{{ metadata.total }}</output>" | safeHTML }}</p>

			<input type="hidden" name="profile" :value="metadata.query.profile">
			<input type="hidden" name="socialnetwork" :value="metadata.query.socialnetwork">

			<input type="hidden" name="authenticated" :value="metadata.query.authenticated">
			<input type="hidden" name="oauth_token" :value="metadata.query.oauth_token">
			<input type="hidden" name="oauth_verifier" :value="metadata.query.oauth_verifier">

			<button name="search_for" value="followers" type="submit">{{ i18n "toCatchMyFollowers" }}</button>
			<button name="search_for" value="friends" type="submit">{{ i18n "toCatchMyFriends" }}</button>
		</fieldset>
	</form>
</script>

<script type="text/x-template" id="profile">
	{{ partial "profile.html" . }}
</script>

{{ if eq (getenv "NODE_ENV") "development" }}
{{ $.Scratch.Add "scriptsFooter" `
<script src="https://vuejs.org/js/vue.js"></script>
` }}
{{ else }}
{{ $.Scratch.Add "scriptsFooter" `
<script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
` }}
{{ end }}

{{ $.Scratch.Add "scriptsFooter" `
<script src="https://cdn.jsdelivr.net/npm/vue-resource@1.3.5"></script>
<script src="/assets/scripts/index.js"></script>
` }}
{{ partial "footer.html" . }}
